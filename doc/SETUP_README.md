# StudyQuest 統合セットアップガイド

## 🚀 デプロイ管理者向け：セットアップ手順

StudyQuestを新しい環境にデプロイする際のセットアップ手順を説明します。

## 📋 セットアップ手順

### ステップ1: プロジェクトの準備
1. Google Apps Scriptプロジェクトにソースコードを配置
2. 必要な権限を確認
   - Google Sheets API
   - Google Drive API
   - Google Forms API（オプション）

### ステップ2: ウェブアプリとして公開
1. Google Apps Scriptエディタで「デプロイ」→「新しいデプロイ」
2. 「種類」を「ウェブアプリ」に選択
3. 実行ユーザーとアクセス権限を設定：
   - **実行ユーザー**: 「自分」
   - **アクセスできるユーザー**: 「全員」（または組織内のみ）
4. 「デプロイ」をクリック
5. 生成されたURLを確認（後で使用）

### ステップ3: 初期設定

1.  コピーしたメインアプリケーションのウェブアプリURLの末尾に `?setup=true` を付けて、ブラウザでアクセスします。
    *   例: `https://script.google.com/macros/s/xxxxx/exec?setup=true`
2.  セットアップページが表示されます。ここで、**「管理者向けログ記録API」のデプロイ時にコピーしたウェブアプリURL**を入力し、「設定を保存」ボタンをクリックします。
3.  設定が正常に保存されると、完了メッセージが表示されます。

## 📊 セットアップで実行される処理

- 環境情報取得
- Logger API URL設定
- ユーザーデータベース作成 (`StudyQuest_UserDatabase` スプレッドシート)
- URL設定初期化
- 設定テスト

## ✅ セットアップ成功後の確認事項

セットアップ完了後、以下を確認してください：

### 1. 管理パネルアクセステスト
```
https://script.google.com/macros/s/YOUR_DEPLOY_ID/exec?mode=admin
```
- 管理画面が正常に表示されることを確認
- スプレッドシートの追加テスト

### 2. 新規登録テスト
```
https://script.google.com/macros/s/YOUR_DEPLOY_ID/exec
```
- 「新規登録」ボタンが表示されることを確認
- テストユーザーでの登録実行

### 3. 回答ボード機能テスト
- スプレッドシートに列設定を行う
- 回答ボードの表示確認
- リアクション機能の動作確認

## 🔧 トラブルシューティング

### よくある問題と解決方法

- **権限エラー**:
  - **症状**: 「認証が必要です」
  - **解決方法**:
    1. Google Apps Scriptでの権限承認を完了
    2. Google Sheets、Drive APIの有効化確認
    3. ユーザーアカウントの権限確認

- **データベース作成エラー**:
  - **症状**: 「ユーザーデータベース作成エラー」
  - **解決方法**:
    1. Google Driveの容量確認
    2. スプレッドシート作成権限の確認
    3. 手動でのスプレッドシート作成テスト

## 📚 関連ドキュメント

- **Code.gs**: メインアプリケーション機能
- **config.gs**: スプレッドシート設定管理
- **SetupCode.gs**: この統合セットアップ機能
- **AdminPanel.html**: 管理画面UI
- **Page.html**: メイン回答ボード画面

## 🎉 セットアップ完了！

セットアップが正常に完了したら、StudyQuestの全機能が利用可能になります。

- **管理者**: 管理パネルでスプレッドシートと表示設定を管理
- **エンドユーザー**: 新規登録から回答ボード利用まで

質問や問題がある場合は、セットアップログの詳細を確認するか、開発チームにお問い合わせください。