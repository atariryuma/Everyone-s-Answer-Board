<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif; padding: 30px; background-color: #f8f9fa; color: #333; }
        .container { max-width: 700px; margin: 0 auto; background-color: #fff; border: 1px solid #dee2e6; padding: 20px 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h2 { color: #495057; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="url"] { width: 100%; padding: 10px; margin-bottom: 20px; box-sizing: border-box; border: 1px solid #ced4da; border-radius: 4px; }
        button { padding: 12px 22px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:disabled { background-color: #6c757d; }
        #message { margin-top: 20px; font-weight: bold; padding: 10px; border-radius: 4px; }
        .success { color: #155724; background-color: #d4edda; border: 1px solid #c3e6cb;}
        .error { color: #721c24; background-color: #f8d7da; border: 1px solid #f5c6cb;}
    </style>
</head>
<body>
    <div class="container">
        <h2>ã¿ã‚“ãªã®å›ç­”ãƒœãƒ¼ãƒ‰ - åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</h2>
        
        <div style="background-color: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
            <h3 style="margin-top: 0; color: #856404;">ğŸ“‹ äº‹å‰æº–å‚™ã®ç¢ºèª</h3>
            <p><strong>Logger APIï¼ˆç®¡ç†è€…å‘ã‘ãƒ­ã‚°è¨˜éŒ²APIï¼‰ãŒæ­£ã—ããƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ï¼š</strong></p>
            <ol>
                <li>Logger APIãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’å®Ÿè¡Œ</li>
                <li>ã€Œç¨®é¡ã€ã‚’ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã«è¨­å®š</li>
                <li>ã€Œå®Ÿè¡Œè€…ã€ã‚’ã€Œè‡ªåˆ†ã€ã«è¨­å®š</li>
                <li>ã€Œã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ã‚’ã€Œã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆåŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å«ã‚€ï¼‰ã€ã«è¨­å®š</li>
                <li>ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦Web App URLã‚’å–å¾—</li>
            </ol>
            <p><strong>é‡è¦ï¼š</strong> Logger APIãŒæ­£ã—ããƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ãªã„å ´åˆã€ã€ŒPage Not Foundã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚</p>
        </div>
        
        <p>Logger APIã®ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªURLã‚’ä»¥ä¸‹ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ï¼š</p>
        <form id="setupForm">
            <label for="apiUrl">Logger API Web App URL:</label>
            <input type="url" id="apiUrl" name="apiUrl" required 
                   placeholder="ä¾‹: https://script.google.com/macros/s/AKfycbxXXXXX/exec"
                   style="font-family: monospace;">
            
            <div style="margin-bottom: 15px; font-size: 12px; color: #6c757d;">
                <strong>æœ‰åŠ¹ãªå½¢å¼:</strong><br>
                â€¢ https://script.google.com/macros/s/xxxxx/exec<br>
                â€¢ https://script.google.com/a/macros/domain.com/s/xxxxx/exec
            </div>
            
            <button type="submit" id="submitBtn">è¨­å®šã‚’ä¿å­˜ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆ</button>
        </form>
        <div id="message"></div>
        
        <div style="margin-top: 30px; font-size: 12px; color: #6c757d; border-top: 1px solid #dee2e6; padding-top: 15px;">
            <strong>ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:</strong><br>
            â€¢ ã€ŒPage Not Foundã€ã‚¨ãƒ©ãƒ¼ â†’ Logger APIã®ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ³ã‚’ç¢ºèª<br>
            â€¢ ã€Œæ¨©é™ã‚¨ãƒ©ãƒ¼ã€â†’ Logger APIã®ã‚¢ã‚¯ã‚»ã‚¹è¨­å®šã‚’ã€Œã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆåŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å«ã‚€ï¼‰ã€ã«å¤‰æ›´<br>
            â€¢ ã€ŒURLå½¢å¼ã‚¨ãƒ©ãƒ¼ã€â†’ ä¸Šè¨˜ã®æœ‰åŠ¹ãªå½¢å¼ã«å¾“ã£ã¦URLã‚’å…¥åŠ›
        </div>
    </div>

    <script>
        document.getElementById('setupForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const apiUrl = document.getElementById('apiUrl').value;
            const btn = document.getElementById('submitBtn');
            const msgDiv = document.getElementById('message');

            btn.disabled = true;
            btn.textContent = 'å‡¦ç†ä¸­...';
            msgDiv.textContent = '';
            msgDiv.className = '';

            google.script.run
                .withSuccessHandler(function(message) {
                    msgDiv.textContent = message;
                    if (message.startsWith('âœ…')) {
                        msgDiv.className = 'success';
                        btn.style.backgroundColor = '#28a745';
                        btn.textContent = 'å®Œäº†';
                    } else {
                        msgDiv.className = 'error';
                        btn.disabled = false;
                        btn.textContent = 'è¨­å®šã‚’ä¿å­˜ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆ';
                    }
                })
                .withFailureHandler(function(error) {
                    msgDiv.className = 'error';
                    msgDiv.textContent = 'ã‚¨ãƒ©ãƒ¼: ' + error.message;
                    btn.disabled = false;
                    btn.textContent = 'è¨­å®šã‚’ä¿å­˜ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆ';
                })
                .saveSettingsAndCreateDb(apiUrl);
        });
    </script>
</body>
</html>