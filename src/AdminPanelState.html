<script>
/* =============================================================================
   StudyQuest - Admin Panel State Management
   Handles client-side state initialization and storage
   ============================================================================= */

/**
 * Application state for the admin panel.
 * @type {Object}
 */
const adminState = {
  userId: '',
  selectedSheet: '',
  currentActiveSheet: '',
  webAppUrl: '',
  currentSpreadsheetUrl: '',
  currentStatus: null,
  isLoading: false,
};

/**
 * Initialize adminState from template or meta tag.
 */
(function initAdminState() {
  try {
    const templateUserId = '<?= typeof userId !== "undefined" ? userId : "" ?>';
    if (templateUserId && templateUserId.trim() !== '') {
      adminState.userId = templateUserId;
      console.log('✅ adminState.userId from template:', adminState.userId);
    } else {
      const userIdMeta = document.querySelector('meta[name="user-id"]');
      if (userIdMeta && userIdMeta.content) {
        adminState.userId = userIdMeta.content;
        console.log('✅ adminState.userId from meta:', adminState.userId);
      }
    }
    if (!adminState.userId) {
      console.error('❌ adminState.userId not found in template or meta');
    }
  } catch (e) {
    console.error('❌ adminState.userId initialization error:', e);
    adminState.userId = '';
  }
})();

// Export to global scope
window.adminState = adminState;
</script>

