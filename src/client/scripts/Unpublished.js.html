    <script>
        function copyBoardUrl() {
            const urlInput = document.getElementById('board-url');
            if (urlInput) {
                try {
                    if (navigator.clipboard && window.isSecureContext) {
                        navigator.clipboard.writeText(urlInput.value);
                    } else {
                        urlInput.select();
                        document.execCommand('copy');
                    }
                    showMessage('URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ', 'success');
                } catch (error) {
                    showMessage('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                }
            }
        }

        function showMessage(message, type = 'info') {
            const messageArea = document.getElementById('message-area');
            if (messageArea) {
                const colors = {
                    success: 'text-green-400 success-state',
                    error: 'text-red-400 error-state', 
                    info: 'text-blue-400'
                };
                messageArea.className = `mb-4 text-center text-sm min-h-[1.25rem] ${colors[type] || 'text-gray-400'}`;
                messageArea.textContent = message;
                
                // Add visual feedback animation
                if (type === 'success' || type === 'error') {
                    setTimeout(() => {
                        messageArea.classList.remove('success-state', 'error-state');
                    }, 600);
                }
                
                setTimeout(() => {
                    messageArea.textContent = '';
                    messageArea.className = 'mb-4 text-center text-sm min-h-[1.25rem]';
                }, 3000);
            }
        }

        // ç®¡ç†è€…ç”¨æ©Ÿèƒ½
        <? if (typeof isOwner !== 'undefined' && isOwner) { ?>
        document.getElementById('add-spreadsheet-btn').addEventListener('click', function() {
            const urlInput = document.getElementById('spreadsheet-url-input');
            const url = urlInput.value.trim();
            
            if (!url) {
                showMessage('ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }
            
            // URLå½¢å¼ãƒã‚§ãƒƒã‚¯
            const googleSheetsPattern = /^https:\/\/docs\.google\.com\/spreadsheets\/d\/[a-zA-Z0-9-_]{10,}/;
            if (!googleSheetsPattern.test(url)) {
                showMessage('æœ‰åŠ¹ãªGoogleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }
            
            // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
            this.disabled = true;
            this.classList.add('loading-state');
            this.innerHTML = '<span role="img" aria-label="èª­ã¿è¾¼ã¿ä¸­">â³</span> è¿½åŠ ä¸­...';
            showMessage('ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’è¿½åŠ ä¸­...', 'info');
            
            // ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
            google.script.run
                .withSuccessHandler((result) => {
                    showMessage(result.message || 'ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸ', 'success');
                    // ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦å›ç­”ãƒœãƒ¼ãƒ‰ã‚’è¡¨ç¤º
                    setTimeout(() => {
                        location.reload();
                    }, 1000);
                })
                .withFailureHandler((error) => {
                    showMessage('ã‚¨ãƒ©ãƒ¼: ' + (error.message || 'ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ'), 'error');
                    this.disabled = false;
                    this.classList.remove('loading-state');
                    this.innerHTML = '<span role="img" aria-label="ãƒ­ã‚±ãƒƒãƒˆ">ğŸš€</span> ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’è¿½åŠ ';
                })
                .addSpreadsheetUrl(url);
        });

        // Enterã‚­ãƒ¼ã§ã‚‚è¿½åŠ 
        document.getElementById('spreadsheet-url-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('add-spreadsheet-btn').click();
            }
        });
        <? } ?>
    </script>
