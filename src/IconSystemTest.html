<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>çµ±ä¸€ã‚¢ã‚¤ã‚³ãƒ³ã‚·ã‚¹ãƒ†ãƒ  - å‹•ä½œæ¤œè¨¼</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .test-section {
      @apply bg-gray-800 rounded-lg p-6 mb-6;
    }
    .icon-demo {
      @apply flex items-center gap-3 p-3 bg-gray-700 rounded mb-2;
    }
    .test-passed {
      @apply text-green-400;
    }
    .test-failed {
      @apply text-red-400;
    }
  </style>
</head>
<body class="bg-gray-900 text-white p-8">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-8 text-center">ğŸ¯ çµ±ä¸€ã‚¢ã‚¤ã‚³ãƒ³ã‚·ã‚¹ãƒ†ãƒ æ¤œè¨¼</h1>
    
    <!-- IconLibraryèª­ã¿è¾¼ã¿ -->
    <script>
      <?!= include('IconLibrary.js'); ?>
    </script>

    <!-- åŸºæœ¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
      <h2 class="text-xl font-bold mb-4">ğŸ“‹ åŸºæœ¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h2>
      <div id="basic-tests"></div>
    </div>

    <!-- ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤ºãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
      <h2 class="text-xl font-bold mb-4">ğŸ¨ ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤ºãƒ†ã‚¹ãƒˆ</h2>
      <div id="icon-display-tests"></div>
    </div>

    <!-- ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
      <h2 class="text-xl font-bold mb-4">ğŸ’¬ ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ</h2>
      <div id="reaction-tests"></div>
    </div>

    <!-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
      <h2 class="text-xl font-bold mb-4">âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ</h2>
      <div id="performance-tests"></div>
    </div>

    <!-- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
      <h2 class="text-xl font-bold mb-4">ğŸ›¡ï¸ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ</h2>
      <div id="error-tests"></div>
    </div>

    <!-- ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼ -->
    <div class="test-section">
      <h2 class="text-xl font-bold mb-4">ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼</h2>
      <div id="test-summary"></div>
    </div>
  </div>

  <script>
    // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œç®¡ç†
    let testResults = {
      passed: 0,
      failed: 0,
      total: 0
    };

    function runTest(name, testFunc, container) {
      testResults.total++;
      try {
        const result = testFunc();
        if (result) {
          testResults.passed++;
          container.innerHTML += `<div class="test-passed">âœ… ${name}: æˆåŠŸ</div>`;
          return true;
        } else {
          testResults.failed++;
          container.innerHTML += `<div class="test-failed">âŒ ${name}: å¤±æ•—</div>`;
          return false;
        }
      } catch (error) {
        testResults.failed++;
        container.innerHTML += `<div class="test-failed">âŒ ${name}: ã‚¨ãƒ©ãƒ¼ - ${error.message}</div>`;
        return false;
      }
    }

    // åŸºæœ¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
    function runBasicTests() {
      const container = document.getElementById('basic-tests');
      
      runTest('IconLibraryã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å­˜åœ¨ç¢ºèª', () => {
        return typeof window.IconLibrary === 'object' && window.IconLibrary !== null;
      }, container);

      runTest('geté–¢æ•°ã®å­˜åœ¨ç¢ºèª', () => {
        return typeof window.IconLibrary.get === 'function';
      }, container);

      runTest('åŸºæœ¬ã‚¢ã‚¤ã‚³ãƒ³å–å¾—ãƒ†ã‚¹ãƒˆ', () => {
        const icon = window.IconLibrary.get('user');
        return typeof icon === 'string' && icon.includes('<svg');
      }, container);

      runTest('åˆ©ç”¨å¯èƒ½ã‚¢ã‚¤ã‚³ãƒ³ä¸€è¦§å–å¾—', () => {
        const icons = window.IconLibrary.list();
        return Array.isArray(icons) && icons.length > 0;
      }, container);

      runTest('ã‚¢ã‚¤ã‚³ãƒ³æ¤œè¨¼æ©Ÿèƒ½', () => {
        return window.IconLibrary.validate('user') === true && 
               window.IconLibrary.validate('nonexistent') === false;
      }, container);
    }

    // ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤ºãƒ†ã‚¹ãƒˆ
    function runIconDisplayTests() {
      const container = document.getElementById('icon-display-tests');
      const testIcons = ['user', 'loading', 'search', 'settings', 'like', 'star'];
      
      testIcons.forEach(iconName => {
        runTest(`${iconName}ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º`, () => {
          const icon = window.IconLibrary.get(iconName, { size: 'w-8 h-8' });
          const testDiv = document.createElement('div');
          testDiv.innerHTML = icon;
          container.appendChild(testDiv);
          
          // è¡¨ç¤ºãƒ†ã‚¹ãƒˆç”¨ã®ãƒ‡ãƒ¢
          const demoDiv = document.createElement('div');
          demoDiv.className = 'icon-demo';
          demoDiv.innerHTML = `
            <span>${icon}</span>
            <span>${iconName}</span>
            <span class="text-green-400 text-sm">âœ“</span>
          `;
          container.appendChild(demoDiv);
          
          return icon.includes('<svg') && icon.includes('w-8 h-8');
        }, container);
      });
    }

    // ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ
    function runReactionTests() {
      const container = document.getElementById('reaction-tests');
      const reactions = ['LIKE', 'UNDERSTAND', 'CURIOUS'];
      
      reactions.forEach(reaction => {
        runTest(`${reaction} - éã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹`, () => {
          const icon = window.IconLibrary.getReaction(reaction, false, 0);
          const demoDiv = document.createElement('div');
          demoDiv.className = 'icon-demo';
          demoDiv.innerHTML = `
            <span>${icon}</span>
            <span>${reaction} (éã‚¢ã‚¯ãƒ†ã‚£ãƒ–)</span>
            <span class="text-green-400 text-sm">âœ“</span>
          `;
          container.appendChild(demoDiv);
          return icon.includes('<svg');
        }, container);

        runTest(`${reaction} - ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹`, () => {
          const icon = window.IconLibrary.getReaction(reaction, true, 5);
          const demoDiv = document.createElement('div');
          demoDiv.className = 'icon-demo';
          demoDiv.innerHTML = `
            <span>${icon}</span>
            <span>${reaction} (ã‚¢ã‚¯ãƒ†ã‚£ãƒ–)</span>
            <span class="text-green-400 text-sm">âœ“</span>
          `;
          container.appendChild(demoDiv);
          return icon.includes('<svg');
        }, container);
      });
    }

    // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
    function runPerformanceTests() {
      const container = document.getElementById('performance-tests');
      
      runTest('å¤§é‡ã‚¢ã‚¤ã‚³ãƒ³å–å¾—ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹', () => {
        const start = performance.now();
        for (let i = 0; i < 1000; i++) {
          window.IconLibrary.get('user');
        }
        const end = performance.now();
        const duration = end - start;
        
        container.innerHTML += `<div class="text-blue-400">ğŸ“ˆ 1000å€‹ã®ã‚¢ã‚¤ã‚³ãƒ³å–å¾—æ™‚é–“: ${duration.toFixed(2)}ms</div>`;
        return duration < 100; // 100msä»¥å†…ã§ã‚ã‚Œã°åˆæ ¼
      }, container);

      runTest('ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯æ¤œæŸ»', () => {
        const initialMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
        for (let i = 0; i < 100; i++) {
          window.IconLibrary.get('loading', { size: 'w-4 h-4' });
        }
        const finalMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
        const memoryIncrease = finalMemory - initialMemory;
        
        container.innerHTML += `<div class="text-blue-400">ğŸ’¾ ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡å¢—åŠ : ${(memoryIncrease / 1024).toFixed(2)}KB</div>`;
        return memoryIncrease < 100000; // 100KBä»¥å†…ã§ã‚ã‚Œã°åˆæ ¼
      }, container);
    }

    // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ
    function runErrorTests() {
      const container = document.getElementById('error-tests');
      
      runTest('å­˜åœ¨ã—ãªã„ã‚¢ã‚¤ã‚³ãƒ³ã®å‡¦ç†', () => {
        const icon = window.IconLibrary.get('nonexistent-icon');
        const demoDiv = document.createElement('div');
        demoDiv.className = 'icon-demo';
        demoDiv.innerHTML = `
          <span>${icon}</span>
          <span>å­˜åœ¨ã—ãªã„ã‚¢ã‚¤ã‚³ãƒ³ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¡¨ç¤º)</span>
          <span class="text-yellow-400 text-sm">âš ï¸</span>
        `;
        container.appendChild(demoDiv);
        return icon.includes('<svg'); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³ãŒè¿”ã•ã‚Œã‚‹
      }, container);

      runTest('ä¸æ­£ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å‡¦ç†', () => {
        const icon = window.IconLibrary.get('user', { 
          size: null, 
          color: undefined, 
          invalidOption: 'test' 
        });
        return icon.includes('<svg');
      }, container);
    }

    // ãƒ†ã‚¹ãƒˆçµæœè¡¨ç¤º
    function displayTestSummary() {
      const container = document.getElementById('test-summary');
      const passRate = (testResults.passed / testResults.total * 100).toFixed(1);
      
      container.innerHTML = `
        <div class="bg-gray-700 rounded p-4">
          <h3 class="text-lg font-bold mb-3">ç·åˆçµæœ</h3>
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
            <div class="bg-green-600 rounded p-3">
              <div class="text-2xl font-bold">${testResults.passed}</div>
              <div class="text-sm">æˆåŠŸ</div>
            </div>
            <div class="bg-red-600 rounded p-3">
              <div class="text-2xl font-bold">${testResults.failed}</div>
              <div class="text-sm">å¤±æ•—</div>
            </div>
            <div class="bg-blue-600 rounded p-3">
              <div class="text-2xl font-bold">${testResults.total}</div>
              <div class="text-sm">ç·æ•°</div>
            </div>
            <div class="bg-purple-600 rounded p-3">
              <div class="text-2xl font-bold">${passRate}%</div>
              <div class="text-sm">æˆåŠŸç‡</div>
            </div>
          </div>
          
          <div class="mt-4 p-3 rounded ${passRate >= 90 ? 'bg-green-700' : passRate >= 70 ? 'bg-yellow-700' : 'bg-red-700'}">
            <strong>
              ${passRate >= 90 ? 'ğŸ‰ å„ªç§€ï¼çµ±ä¸€ã‚¢ã‚¤ã‚³ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã¯æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ã€‚' : 
                passRate >= 70 ? 'âš ï¸ æ³¨æ„ï¼šã„ãã¤ã‹ã®å•é¡ŒãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚' : 
                'âŒ é‡å¤§ï¼šå¤šæ•°ã®å•é¡ŒãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚ä¿®æ­£ãŒå¿…è¦ã§ã™ã€‚'}
            </strong>
          </div>
        </div>
      `;
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†å¾Œã«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        console.log('ğŸ§ª çµ±ä¸€ã‚¢ã‚¤ã‚³ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¾ã™...');
        
        runBasicTests();
        runIconDisplayTests();
        runReactionTests();
        runPerformanceTests();
        runErrorTests();
        displayTestSummary();
        
        console.log('âœ… ãƒ†ã‚¹ãƒˆå®Œäº†:', testResults);
      }, 100);
    });
  </script>
</body>
</html>