<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>StudyQuest -ã¿ã‚“ãªã®å›ç­”ãƒœãƒ¼ãƒ‰- - ã¿ã‚“ãªã®ã‹ã„ã¨ã†ãƒœãƒ¼ãƒ‰</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="referrer" content="no-referrer">
<!-- Content Security Policy for enhanced security -->
<meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.tailwindcss.com https://fonts.googleapis.com https://script.google.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.tailwindcss.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self' https:; img-src 'self' data: https:;">
<!-- Permissions Policy to silence console warnings -->
<meta http-equiv="Permissions-Policy" content="ambient-light-sensor=(), camera=(), geolocation=(), gyroscope=(), magnetometer=(), microphone=(), payment=(), usb=(), speaker=(), vibrate=(), vr=()">
<!-- Preload Google Fonts for better performance -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&amp;display=swap" rel="stylesheet">
<!-- Global error handling and TailwindCSS setup -->
<script>
// Global error handling for document.write and other issues
window.addEventListener('error', function(event) {
  if (event.error && event.error.message) {
    if (event.error.message.includes('document.write') ||
        event.error.message.includes('Unexpected token')) {
      console.warn('Document.write or syntax error caught and handled:', event.error.message);
      event.preventDefault();
      return false;
    }
  }
});

// Handle unhandled promise rejections
window.addEventListener('unhandledrejection', function(event) {
  console.warn('Unhandled promise rejection:', event.reason);
  event.preventDefault();
});

// TailwindCSS configuration to suppress production warnings
window.tailwind = {
  config: {
    mode: 'jit',
    corePlugins: { preflight: false }
  }
};
</script>
<script src="https://cdn.tailwindcss.com" defer onload="console.log('TailwindCSS loaded successfully')" onerror="console.warn('TailwindCSS failed to load')"></script>

<?!= include('pages/Board.js'); ?>

<?!= include('pages/Board.css'); ?>
</head>
<body class="bg-[#1a1b26] text-gray-200 font-sans">
<!-- Loading Overlay -->
<div id="loading-overlay" class="loading-overlay hidden">
  <div class="text-center">
    <div class="spinner"></div>
    <p class="mt-4 text-gray-300">èª­ã¿è¾¼ã¿ä¸­...</p>
  </div>
</div>

<div id="main-container" class="w-full mx-auto px-4 pt-4 pb-4 md:px-6 md:pt-6 md:pb-6">
<!-- ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ -->
<header id="main-header" class="glass-panel rounded-xl p-3 mb-4 shadow-lg fade-in">
  <!-- ä¸Šéƒ¨: ãƒ•ã‚©ãƒ¼ãƒ ãƒªãƒ³ã‚¯ + ãƒ‰ãƒ¡ã‚¤ãƒ³æƒ…å ±ï¼ˆæ¨ªä¸¦ã³ï¼‰ -->
  <div class="flex items-center justify-between mb-3 text-xs">
    <!-- ãƒ•ã‚©ãƒ¼ãƒ ãƒªãƒ³ã‚¯ï¼ˆå·¦å´ï¼‰ -->
    <a id="form-link-btn" href="#" target="_blank" class="bg-cyan-500/10 border border-cyan-400/30 rounded px-3 py-1 flex items-center gap-2 hover:bg-cyan-500/20 transition-all text-cyan-400 hover:text-cyan-300 hidden">
      <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
      </svg>
      <span class="font-medium">ğŸ“ å›ç­”ãƒ•ã‚©ãƒ¼ãƒ </span>
    </a>
    
    <!-- ãƒ‰ãƒ¡ã‚¤ãƒ³æƒ…å ±ã¨ç®¡ç†ãƒ¢ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ï¼ˆå³å´ï¼‰ -->
    <div class="flex-shrink-0 flex items-center gap-2">
      <div>
        <!-- ãƒ‰ãƒ¡ã‚¤ãƒ³ä¸€è‡´è¡¨ç¤º -->
        <div id="header-domain-match" class="bg-green-500/10 border border-green-400/30 rounded px-2 py-1 hidden">
          <div class="flex items-center gap-1">
            <svg class="w-3 h-3 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span class="text-green-400 font-medium" id="header-domain-match-text">å­¦æ ¡ãƒ‰ãƒ¡ã‚¤ãƒ³</span>
          </div>
        </div>
        
        <!-- ãƒ‰ãƒ¡ã‚¤ãƒ³ä¸ä¸€è‡´è¡¨ç¤º -->
        <div id="header-domain-mismatch" class="bg-yellow-500/10 border border-yellow-400/30 rounded px-2 py-1 hidden">
          <div class="flex items-center gap-1">
            <svg class="w-3 h-3 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
            </svg>
            <span class="text-yellow-400 font-medium" id="header-domain-mismatch-text">å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹</span>
          </div>
        </div>
        
        <!-- åˆæœŸçŠ¶æ…‹è¡¨ç¤º -->
        <div id="header-domain-initial" class="bg-blue-500/10 border border-blue-400/30 rounded px-2 py-1">
          <div class="flex items-center gap-1">
            <div class="w-2 h-2 bg-blue-400 rounded-full animate-pulse"></div>
            <span class="text-blue-400 font-medium">ç¢ºèªä¸­</span>
          </div>
        </div>
      </div>
      
      <!-- ç®¡ç†ãƒ¢ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ -->
      <button type="button" id="adminToggleBtn" class="admin-toggle text-xs text-gray-500 hover:text-cyan-400 transition-all opacity-60 hover:opacity-100 hidden whitespace-nowrap flex items-center gap-1 px-2 py-1 rounded" hidden aria-label="ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ">
        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
        </svg>
      </button>
    </div>
  </div>
  
  <!-- ãƒ¡ã‚¤ãƒ³éƒ¨åˆ†: å•é¡Œã‚¿ã‚¤ãƒˆãƒ« + ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
  <div class="flex flex-col lg:flex-row items-center gap-3">
    <!-- å·¦: ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
    <div class="flex items-center gap-3 text-xs">
      <div id="answerCount" class="text-gray-400 flex items-center gap-1">
        <svg class="w-3 h-3 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
        </svg>
        <span id="answerCountText">0ä»¶</span>
      </div>
      
      <select id="classFilter" class="hidden text-xs bg-gray-700 border border-gray-600 rounded px-2 py-1" title="ã‚¯ãƒ©ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼" aria-label="ã‚¯ãƒ©ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼"></select>
      
      <div class="relative">
        <select id="sortOrder" class="text-xs bg-gray-700 border border-gray-600 rounded px-2 py-1 pr-6 appearance-none" title="ä¸¦ã³é †" aria-label="ä¸¦ã³é †">
          <option value="newest" selected>æ–°ç€é †</option>
          <option value="random">ãƒ©ãƒ³ãƒ€ãƒ é †</option>
          <option value="score" id="scoreOption" class="hidden">ã‚¹ã‚³ã‚¢é †</option>
        </select>
        <svg class="absolute right-1 top-1/2 transform -translate-y-1/2 w-2 h-2 text-gray-400 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
      </div>
    </div>

    <!-- ä¸­å¤®: å•é¡Œã‚¿ã‚¤ãƒˆãƒ«ï¼ˆæœ€å¤§ï¼‰ -->
    <div class="flex-grow text-center min-w-0">
      <div id="headingLabel" class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold text-pink-400 leading-tight">
        <svg class="w-5 h-5 md:w-6 md:h-6 animate-spin" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" fill="currentColor"></path>
        </svg>
      </div>
    </div>

  <!-- Right Section: Info & Admin Controls -->
  <div class="w-full lg:w-auto lg:min-w-[150px] text-right space-y-1 px-2">
    <p id="sheetNameText" class="text-xs text-gray-400 h-4 truncate flex items-center justify-end gap-1">
    </p>
    <div class="flex justify-end gap-1 flex-wrap">
      <button type="button" id="endPublicationBtn" class="admin-toggle text-xs bg-orange-600 hover:bg-orange-700 text-white px-3 py-1 rounded hidden whitespace-nowrap transition-all flex items-center gap-1" hidden aria-label="å…¬é–‹çµ‚äº†">
        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L5.636 5.636"></path>
        </svg>
        å…¬é–‹çµ‚äº†
      </button>
    </div>
  </div>
</header>
<!-- æ–°ç€é€šçŸ¥ãƒãƒŠãƒ¼ -->
<div id="newContentBanner" class="fixed top-20 left-1/2 transform -translate-x-1/2 z-50 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-full shadow-lg hidden transition-all duration-300" role="alert" aria-live="polite">
  <div class="flex items-center gap-3">
    <span id="newContentIcon" class="w-5 h-5 animate-pulse" aria-hidden="true">ğŸ“‹</span>
    <span id="newContentText">æ–°ã—ã„æ„è¦‹ãŒæŠ•ç¨¿ã•ã‚Œã¾ã—ãŸ</span>
    <button type="button" id="refreshContentBtn" class="bg-white/20 hover:bg-white/30 px-3 py-1 rounded-full text-sm font-medium transition-colors" aria-label="æ–°ã—ã„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æ›´æ–°ã—ã¦è¡¨ç¤º">
      æ›´æ–°ã—ã¦è¡¨ç¤º
    </button>
    <button type="button" id="dismissBannerBtn" class="text-white/70 hover:text-white w-5 h-5 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors" aria-label="é€šçŸ¥ã‚’é–‰ã˜ã‚‹">
      Ã—
    </button>
  </div>
</div>

<main id="answers" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" role="main" aria-live="polite" aria-label="å›ç­”ä¸€è¦§"></main>
</div>
<div id="answerModalContainer" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden" role="dialog" aria-modal="true">
<div id="answerModalCard" class="glass-panel rounded-xl p-6 flex flex-col shadow-2xl border-2 border-cyan-400/80 w-full max-w-5xl h-auto max-h-[85vh] relative" role="document" aria-labelledby="modalAnswer">
<button type="button" id="answerModalCloseBtn" class="modal-close-btn bg-red-600 rounded-full p-2 text-white hover:scale-110 transition-transform z-10" aria-label="é–‰ã˜ã‚‹">
  <span id="iconClose" class="w-6 h-6"></span>
</button>
<div id="modalAnswer" class="flex-grow min-h-[200px] mb-4 overflow-y-auto pr-4"></div>
<div id="modalFooter" class="text-xs text-gray-400 pt-4 border-t-2 border-dashed border-cyan-400/80 flex justify-between items-center">
<div><span id="modalStudentName" class="font-bold text-2xl text-gray-200"></span></div>
<div id="modalReactions" class="flex items-center gap-2"></div>
</div>
</div>
</div>
<div id="infoModalContainer" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden" role="dialog" aria-modal="true">
<div id="infoModalCard" class="glass-panel rounded-xl p-8 shadow-2xl border-2 border-cyan-400/80 w-full max-w-2xl relative" role="document">
<div class="space-y-5 text-gray-200 text-lg leading-relaxed">
<!-- Digital Citizenship Education Section -->
<div class="bg-gradient-to-r from-green-800/40 to-emerald-800/40 border border-green-400/50 rounded-lg p-4 mb-4">
<div class="flex items-start gap-3">
<div class="w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
<span class="text-lg">ğŸ“š</span>
</div>
<div>
<p class="text-base font-bold text-green-200 mb-3">ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ»ã‚·ãƒ†ã‚£ã‚ºãƒ³ã‚·ãƒƒãƒ—ã£ã¦ä½•ã ã‚ã†ï¼Ÿ</p>
<p class="text-sm text-green-100 leading-relaxed mb-2">
<span class="text-green-200 font-semibold">ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ»ã‚·ãƒ†ã‚£ã‚ºãƒ³ã‚·ãƒƒãƒ—</span>ã¨ã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã‚„ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã‚’ä½¿ã†ã¨ãã«ã€<span class="text-green-200 font-semibold">ã‚„ã•ã—ã„å¿ƒã§ç›¸æ‰‹ã®ã“ã¨ã‚’è€ƒãˆã‚‹</span>ã“ã¨ã§ã™ã€‚
</p>
<p class="text-sm text-green-200 leading-relaxed mb-2">
ã¿ã‚“ãªã®å›ç­”ãƒœãƒ¼ãƒ‰ã§ã‚‚ã€<span class="text-green-200 font-semibold">æ€ã„ã‚„ã‚Šã®ã‚ã‚‹è¨€è‘‰</span>ã‚’é¸ã‚“ã§ã€ã¿ã‚“ãªãŒæ°—æŒã¡ã‚ˆãå‚åŠ ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚
</p>
<p class="text-sm text-green-200 leading-relaxed">
å‹ã ã¡ã®æ„è¦‹ã‚’èã„ã¦ã€Œãã†ã„ã†è€ƒãˆã‚‚ã‚ã‚‹ã‚“ã ã­ã€ã¨<span class="text-green-200 font-semibold">å¤šæ§˜æ€§ã‚’å¤§åˆ‡ã«ã™ã‚‹å¿ƒ</span>ã‚’è‚²ã¦ã¾ã—ã‚‡ã†ã€‚
</p>
</div>
</div>
</div>

<p>ã¿ã‚“ãªã®æ„è¦‹ã‚’æ°—æŒã¡ã‚ˆãå…±æœ‰ã™ã‚‹ãŸã‚ã«ã€ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ã—ã‹ãŸã‚’ãŠã¼ãˆã‚ˆã†ï¼</p>
<ul class="space-y-2">
<li class="flex items-center gap-2"><span id="infoIconLike" class="w-5 h-5 text-red-400"></span>ã„ã„ã­ï¼ï¼šã™ã¦ãã ã¨æ€ã£ãŸã¨ãã«æŠ¼ãã†</li>
<li class="flex items-center gap-2"><span id="infoIconUnderstand" class="w-5 h-5 text-yellow-400"></span>ãªã‚‹ã»ã©ï¼ï¼šå‚è€ƒã«ãªã£ãŸã¨ãã«æŠ¼ãã†</li>
<li class="flex items-center gap-2"><span id="infoIconCurious" class="w-5 h-5 text-green-400"></span>ã‚‚ã£ã¨çŸ¥ã‚ŠãŸã„ï¼ï¼šã‚‚ã£ã¨çŸ¥ã‚ŠãŸã„ã¨ãã«æŠ¼ãã†</li>
</ul>
<p class="flex items-center gap-2"><span id="infoIconHighlight" class="w-5 h-5 text-purple-400"></span>å…ˆç”ŸãŒæ³¨ç›®ã—ã¦ã»ã—ã„æ„è¦‹ã«ã¤ã‘ã¦ã„ã¾ã™</p>
<p>è²¬ä»»ã‚ã‚‹ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§ã€ã¿ã‚“ãªã§å­¦ã³ã‚’æ·±ã‚ã‚ˆã†ï¼</p>


<div class="text-center mt-6">
<button type="button" id="infoModalConfirmBtn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">ã‚ã‹ã£ãŸ</button>
</div>
</div>
</div>
</div>
<footer id="controlsFooter" class="fixed bottom-0 left-0 right-0 z-40 p-4">
<div class="glass-panel max-w-md mx-auto rounded-xl p-3 flex items-center justify-center gap-3">
<input type="range" id="sizeSlider" min="2" max="6" value="4" class="w-1/2" aria-label="è¡¨ç¤ºåˆ—æ•°ã®å¤‰æ›´">
<div class="flex items-center gap-1">
<span id="sliderValue" class="font-bold text-lg">4</span>
<span id="iconGrid" class="w-4 h-4"></span>
</div>
</div>
</footer>
</body>
</html>