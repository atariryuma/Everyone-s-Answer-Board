<script>
// TailwindCSS è¨­å®š - ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼è¨­è¨ˆç”¨æœ€é©åŒ–
window.tailwind = {
  config: {
    corePlugins: {
      preflight: true, // æœ‰åŠ¹åŒ–ï¼šé©åˆ‡ãªCSSãƒªã‚»ãƒƒãƒˆã‚’æä¾›
      container: false, // ç„¡åŠ¹åŒ–ï¼šã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ³ãƒ†ãƒŠã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨
    },
    prefix: '',
    important: false,
    theme: {
      extend: {
        // ãƒ‡ã‚¶ã‚¤ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã®é€£æº
        colors: {
          'glass-primary': 'rgba(26, 27, 38, 0.65)',
          'glass-secondary': 'rgba(255, 255, 255, 0.08)',
          'glass-hover': 'rgba(255, 255, 255, 0.12)',
          'glass-active': 'rgba(255, 255, 255, 0.16)',
          'glass-disabled': 'rgba(255, 255, 255, 0.04)',
          'primary': '#06b6d4',
          'secondary': '#a855f7',
          'success': '#10b981',
          'error': '#ef4444',
          'warning': '#f59e0b',
          'info': '#3b82f6',
        },
        spacing: {
          'xs': '4px',
          'sm': '8px',
          'md': '16px',
          'lg': '24px',
          'xl': '32px',
          '2xl': '48px',
          '3xl': '64px',
        },
        fontSize: {
          'xs': '12px',
          'sm': '14px',
          'base': '16px',
          'lg': '18px',
          'xl': '20px',
          '2xl': '24px',
          '3xl': '30px',
          '4xl': '36px',
        },
        borderRadius: {
          'sm': '4px',
          'md': '8px',
          'lg': '12px',
          'xl': '16px',
          '2xl': '24px',
        },
        zIndex: {
          'base': '0',
          'raised': '1',
          'dropdown': '100',
          'sticky': '200',
          'modal': '1000',
          'tooltip': '1100',
          'overlay': '1200',
        },
        backdropBlur: {
          'glass': '20px',
          'glass-strong': '32px',
        },
        transitionDuration: {
          'fast': '150ms',
          'normal': '250ms',
          'slow': '350ms',
          'slower': '500ms',
        },
        transitionTimingFunction: {
          'standard': 'cubic-bezier(0.4, 0, 0.2, 1)',
          'in': 'cubic-bezier(0.4, 0, 1, 1)',
          'out': 'cubic-bezier(0, 0, 0.2, 1)',
          'in-out': 'cubic-bezier(0.4, 0, 0.6, 1)',
        }
      }
    }
  }
};
</script>

<style>
/* CSS ãƒ¬ã‚¤ãƒ¤ãƒ¼å®šç¾© - ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ */
@layer base, components, utilities, page-specific;

/* Tailwind CSS ãƒ—ãƒªãƒ•ãƒ©ã‚¤ãƒˆä¸Šæ›¸ã */
@layer base {
  /* ãƒ‡ã‚¶ã‚¤ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³ã®ç¶™æ‰¿ */
  html {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Inter', sans-serif;
    line-height: 1.5;
    -webkit-text-size-adjust: 100%;
    -moz-tab-size: 4;
    tab-size: 4;
  }
  
  body {
    margin: 0;
    font-family: inherit;
    line-height: inherit;
  }
  
  /* ã‚°ãƒ­ãƒ¼ãƒãƒ«è¦ç´ ã®ãƒªã‚»ãƒƒãƒˆ */
  *,
  ::before,
  ::after {
    box-sizing: border-box;
    border-width: 0;
    border-style: solid;
    border-color: theme('borderColor.DEFAULT', currentColor);
  }
  
  /* ãƒ•ã‚©ãƒ¼ã‚«ã‚¹è¨­å®š */
  *:focus {
    outline: 2px solid transparent;
    outline-offset: 2px;
  }
}

/* ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼ - ä½ç‰¹ç•°æ€§ */
@layer components {
  /* åŸºæœ¬çš„ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ã®ã¿ */
  .btn {
    @apply inline-flex items-center justify-center px-lg py-md text-sm font-semibold rounded-lg border transition-all duration-normal;
  }
  
  .form-control {
    @apply w-full px-lg py-md text-sm rounded-lg border transition-all duration-normal;
  }
  
  .glass-panel {
    @apply relative p-xl rounded-2xl border transition-all duration-normal;
  }
}

/* ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ¬ã‚¤ãƒ¤ãƒ¼ - æœ€é«˜ç‰¹ç•°æ€§ */
@layer utilities {
  /* é‡è¦ãªã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ç”¨ */
  .backdrop-blur-glass {
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
  }
  
  .backdrop-blur-glass-strong {
    backdrop-filter: blur(32px);
    -webkit-backdrop-filter: blur(32px);
  }
  
  .glass-shadow {
    box-shadow: 
      0 8px 32px rgba(0, 0, 0, 0.12),
      0 2px 8px rgba(0, 0, 0, 0.08),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
  }
  
  .glass-shadow-hover {
    box-shadow: 
      0 12px 40px rgba(0, 0, 0, 0.15),
      0 4px 12px rgba(0, 0, 0, 0.10),
      inset 0 1px 0 rgba(255, 255, 255, 0.15);
  }
}

/* ãƒšãƒ¼ã‚¸å›ºæœ‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ - æœ€å„ªå…ˆ */
@layer page-specific {
  /* ãƒšãƒ¼ã‚¸å›ºæœ‰ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã“ã“ã«é…ç½® */
  /* ä¾‹: .setup-page .specific-override { ... } */
}
</style>

<script src="https://cdn.tailwindcss.com" defer onerror="console.warn('TailwindCSS failed to load')"></script>

<!-- AdminPanel Layout Override Script - Executes after Tailwind CDN loads -->
<script>
// Wait for Tailwind to load and then inject admin panel styles
document.addEventListener('DOMContentLoaded', function() {
  // Delay to ensure Tailwind CDN has loaded
  setTimeout(function() {
    const adminStylesheet = document.createElement('style');
    adminStylesheet.id = 'admin-panel-override';
    adminStylesheet.innerHTML = `
/* Admin Panel Layout Override - Higher specificity to override Tailwind CDN */
body.admin-grid-layout .admin-responsive-grid {
  display: grid !important;
  grid-template-columns: 2fr 1fr !important;
  gap: 2rem !important;
  align-items: start !important;
  max-width: 84rem !important;
  margin: 0 auto !important;
  padding: 0 1rem !important;
  width: 100% !important;
}

body.admin-grid-layout .admin-responsive-grid .left-panel,
body.admin-grid-layout .admin-responsive-grid .right-panel {
  min-width: 0 !important;
  display: flex !important;
  flex-direction: column !important;
  gap: 1.5rem !important;
  flex: none !important;
  margin: 0 !important;
}

body.admin-grid-layout .admin-responsive-grid .left-panel {
  grid-column: 1 !important;
}

body.admin-grid-layout .admin-responsive-grid .right-panel {
  grid-column: 2 !important;
  position: sticky !important;
  top: 1.5rem !important;
  max-height: calc(100vh - 3rem) !important;
  overflow-y: auto !important;
}

/* Mobile Override */
@media (max-width: 1024px) {
  body.admin-grid-layout .admin-responsive-grid {
    grid-template-columns: 1fr !important;
    gap: 1.5rem !important;
    padding: 0 !important;
  }
  
  body.admin-grid-layout .admin-responsive-grid .left-panel {
    order: 2 !important;
    grid-column: auto !important;
  }
  
  body.admin-grid-layout .admin-responsive-grid .right-panel {
    order: 1 !important;
    grid-column: auto !important;
    position: static !important;
    max-height: none !important;
    overflow-y: visible !important;
  }
}
`;
    document.head.appendChild(adminStylesheet);
    
    // Detailed override logging
    console.group('âœ… Admin panel layout override applied - è©³ç´°æƒ…å ±');
    console.log('ğŸ“ Override Stylesheet ID:', adminStylesheet.id);
    console.log('ğŸ“ Injection Time:', new Date().toLocaleTimeString());
    
    // Verify the grid immediately after injection
    setTimeout(function() {
      const adminGrid = document.querySelector('.admin-responsive-grid');
      if (adminGrid) {
        const computedStyle = window.getComputedStyle(adminGrid);
        console.log('ğŸ“ Gridç¢ºèªçµæœ:');
        console.log('  â”œâ”€ Display:', computedStyle.display);
        console.log('  â”œâ”€ Grid Template Columns:', computedStyle.gridTemplateColumns);
        console.log('  â”œâ”€ Gap:', computedStyle.gap);
        console.log('  â”œâ”€ Max Width:', computedStyle.maxWidth);
        console.log('  â””â”€ Width:', computedStyle.width);
        
        // Check if 2-column layout is working
        const isCorrectLayout = computedStyle.gridTemplateColumns.includes('2fr 1fr') || 
                               computedStyle.gridTemplateColumns.includes('2fr') && computedStyle.gridTemplateColumns.includes('1fr');
        console.log('ğŸ¯ 2ã‚«ãƒ©ãƒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ:', isCorrectLayout ? 'âœ… æ­£å¸¸' : 'âŒ ç•°å¸¸');
        
        // Panel width verification
        const leftPanel = adminGrid.querySelector('.left-panel');
        const rightPanel = adminGrid.querySelector('.right-panel');
        if (leftPanel && rightPanel) {
          console.log('ğŸ“± Panelå¹…ç¢ºèª:');
          console.log('  â”œâ”€ Left Panel:', leftPanel.offsetWidth + 'px');
          console.log('  â”œâ”€ Right Panel:', rightPanel.offsetWidth + 'px');
          console.log('  â””â”€ æ¯”ç‡:', leftPanel.offsetWidth && rightPanel.offsetWidth ? 
                     (leftPanel.offsetWidth / rightPanel.offsetWidth).toFixed(2) + ':1' : 'N/A');
        }
      } else {
        console.log('âŒ Admin grid not found after override');
      }
      console.groupEnd();
    }, 10);
  }, 100); // 100ms delay to ensure Tailwind has loaded
  
  // Add layout change monitoring
  if (typeof ResizeObserver !== 'undefined') {
    const resizeObserver = new ResizeObserver(function(entries) {
      entries.forEach(function(entry) {
        if (entry.target.classList.contains('admin-responsive-grid')) {
          console.log('ğŸ“ Layoutå¤‰æ›´æ¤œå‡º:', {
            width: entry.contentRect.width,
            height: entry.contentRect.height,
            timestamp: new Date().toLocaleTimeString()
          });
        }
      });
    });
    
    // Start observing when grid is available
    setTimeout(function() {
      const adminGrid = document.querySelector('.admin-responsive-grid');
      if (adminGrid) {
        resizeObserver.observe(adminGrid);
        console.log('ğŸ‘ï¸ Layout monitoring started');
      }
    }, 200);
  }
});
</script>

<!-- çµ±åˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚·ã‚¹ãƒ†ãƒ  - iframeå¯¾å¿œ -->
<script>
// çµ±åˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆiframeç’°å¢ƒå¯¾å¿œï¼‰
window.unifiedLayoutSystem = {
  initialized: false,
  
  // ãƒ¡ã‚¤ãƒ³ã®åˆæœŸåŒ–é–¢æ•°
  init: function() {
    if (this.initialized) return;
    
    console.log('ğŸš€ [UNIFIED LAYOUT] System initialization...');
    
    // iframeç’°å¢ƒã§ã®å³åº§ã®å¯¾å¿œ
    if (window.iframeLayoutSystem) {
      window.iframeLayoutSystem.init();
    }
    
    // DOMæº–å‚™å®Œäº†å¾Œã®å‡¦ç†
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => this.setupLayout());
    } else {
      this.setupLayout();
    }
    
    // TailwindCSSèª­ã¿è¾¼ã¿å¾Œã®å‡¦ç†
    setTimeout(() => this.injectAdminStyles(), 150);
    
    this.initialized = true;
  },
  
  // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
  setupLayout: function() {
    console.log('ğŸ”§ [UNIFIED LAYOUT] Setting up layout...');
    
    // bodyè¦ç´ ã«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
    if (document.body) {
      document.body.classList.add('admin-grid-layout');
      
      // iframeç’°å¢ƒã®å ´åˆã¯è¿½åŠ ã®ã‚¯ãƒ©ã‚¹
      if (window !== window.top) {
        document.body.classList.add('iframe-environment');
      }
    }
    
    // å°‘ã—é…ã‚‰ã›ã¦ã‚¹ã‚¿ã‚¤ãƒ«ã‚’æ³¨å…¥
    setTimeout(() => this.injectAdminStyles(), 50);
  },
  
  // Admin Panelå°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ«ã®æ³¨å…¥
  injectAdminStyles: function() {
    // æ—¢å­˜ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã‚’ãƒã‚§ãƒƒã‚¯
    if (document.getElementById('unified-admin-layout')) {
      console.log('âš ï¸ [UNIFIED LAYOUT] Admin styles already injected');
      return;
    }
    
    console.log('ğŸ’‰ [UNIFIED LAYOUT] Injecting admin panel styles...');
    
    const unifiedStylesheet = document.createElement('style');
    unifiedStylesheet.id = 'unified-admin-layout';
    unifiedStylesheet.innerHTML = `
/* =============================================================================
   Unified Admin Layout System - çµ±åˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚·ã‚¹ãƒ†ãƒ 
   iframeç’°å¢ƒã¨ãƒã‚¤ãƒ†ã‚£ãƒ–ç’°å¢ƒã®ä¸¡æ–¹ã«å¯¾å¿œ
   ============================================================================= */

/* åŸºæœ¬çš„ãªAdmin Panel ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
body.admin-grid-layout .admin-responsive-grid,
.admin-responsive-grid {
  display: grid !important;
  grid-template-columns: 2fr 1fr !important;
  gap: 2rem !important;
  align-items: start !important;
  max-width: 84rem !important;
  margin: 0 auto !important;
  padding: 0 1rem !important;
  width: 100% !important;
  box-sizing: border-box !important;
  min-height: 0 !important;
}

/* ãƒ‘ãƒãƒ«ã®åŸºæœ¬è¨­å®š */
body.admin-grid-layout .admin-responsive-grid .left-panel,
body.admin-grid-layout .admin-responsive-grid .right-panel,
.admin-responsive-grid .left-panel,
.admin-responsive-grid .right-panel {
  min-width: 0 !important;
  display: flex !important;
  flex-direction: column !important;
  gap: 1.5rem !important;
  flex: none !important;
  margin: 0 !important;
  box-sizing: border-box !important;
  width: 100% !important;
}

/* å·¦ãƒ‘ãƒãƒ« */
body.admin-grid-layout .admin-responsive-grid .left-panel,
.admin-responsive-grid .left-panel {
  grid-column: 1 !important;
  min-width: 0 !important;
}

/* å³ãƒ‘ãƒãƒ« */
body.admin-grid-layout .admin-responsive-grid .right-panel,
.admin-responsive-grid .right-panel {
  grid-column: 2 !important;
  position: sticky !important;
  top: 1.5rem !important;
  max-height: calc(100vh - 3rem) !important;
  overflow-y: auto !important;
  min-width: 0 !important;
}

/* iframeç’°å¢ƒã§ã®è¿½åŠ å¼·åŒ– */
body.iframe-environment .admin-responsive-grid {
  isolation: isolate !important;
  contain: layout style paint !important;
}

/* ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
@media (max-width: 1024px) {
  body.admin-grid-layout .admin-responsive-grid,
  .admin-responsive-grid {
    grid-template-columns: 1fr !important;
    gap: 1.5rem !important;
    padding: 0 !important;
  }
  
  body.admin-grid-layout .admin-responsive-grid .left-panel,
  .admin-responsive-grid .left-panel {
    order: 2 !important;
    grid-column: auto !important;
  }
  
  body.admin-grid-layout .admin-responsive-grid .right-panel,
  .admin-responsive-grid .right-panel {
    order: 1 !important;
    grid-column: auto !important;
    position: static !important;
    max-height: none !important;
    overflow-y: visible !important;
  }
}

/* Tailwindä¸Šæ›¸ãé˜²æ­¢ã®è¿½åŠ ä¿è­· */
.tailwind-override-protection .admin-responsive-grid {
  display: grid !important;
  grid-template-columns: 2fr 1fr !important;
}

/* ãƒ‡ãƒãƒƒã‚°ç”¨ã®è¦–è¦šçš„ç¢ºèª */
.debug-layout .admin-responsive-grid {
  outline: 2px solid #06b6d4 !important;
}

.debug-layout .left-panel {
  outline: 1px solid #10b981 !important;
}

.debug-layout .right-panel {
  outline: 1px solid #a855f7 !important;
}
`;
    
    // æœ€é«˜å„ªå…ˆåº¦ã§æ³¨å…¥
    document.head.appendChild(unifiedStylesheet);
    
    // æ³¨å…¥å¾Œã®æ¤œè¨¼
    setTimeout(() => this.verifyLayout(), 100);
  },
  
  // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ¤œè¨¼
  verifyLayout: function() {
    console.group('ğŸ” [UNIFIED LAYOUT] Layout Verification');
    
    const adminGrid = document.querySelector('.admin-responsive-grid');
    if (adminGrid) {
      const computedStyle = window.getComputedStyle(adminGrid);
      const isCorrectLayout = computedStyle.gridTemplateColumns.includes('2fr 1fr') ||
                             (computedStyle.gridTemplateColumns.includes('2fr') && 
                              computedStyle.gridTemplateColumns.includes('1fr'));
      
      console.log('ğŸ“ Grid Status:');
      console.log('  â”œâ”€ Found:', 'âœ… YES');
      console.log('  â”œâ”€ Display:', computedStyle.display);
      console.log('  â”œâ”€ Columns:', computedStyle.gridTemplateColumns);
      console.log('  â”œâ”€ Gap:', computedStyle.gap);
      console.log('  â”œâ”€ Width:', computedStyle.width);
      console.log('  â””â”€ Layout Correct:', isCorrectLayout ? 'âœ… YES' : 'âŒ NO');
      
      // ãƒ‘ãƒãƒ«çŠ¶æ…‹ã®ç¢ºèª
      const leftPanel = adminGrid.querySelector('.left-panel');
      const rightPanel = adminGrid.querySelector('.right-panel');
      
      if (leftPanel && rightPanel) {
        console.log('ğŸ“± Panel Status:');
        console.log('  â”œâ”€ Left Width:', leftPanel.offsetWidth + 'px');
        console.log('  â”œâ”€ Right Width:', rightPanel.offsetWidth + 'px');
        console.log('  â””â”€ Ratio:', leftPanel.offsetWidth && rightPanel.offsetWidth ? 
                   (leftPanel.offsetWidth / rightPanel.offsetWidth).toFixed(2) + ':1' : 'N/A');
      }
      
      // å•é¡ŒãŒã‚ã‚‹å ´åˆã¯ç·Šæ€¥ä¿®å¾©
      if (!isCorrectLayout) {
        console.warn('âš ï¸ [UNIFIED LAYOUT] Layout issue detected, attempting emergency repair...');
        this.emergencyRepair();
      }
    } else {
      console.log('âŒ Admin grid not found');
    }
    
    console.groupEnd();
  },
  
  // ç·Šæ€¥ä¿®å¾©
  emergencyRepair: function() {
    console.log('ğŸš¨ [UNIFIED LAYOUT] Emergency repair initiated');
    
    const adminGrid = document.querySelector('.admin-responsive-grid');
    if (adminGrid) {
      // ç·Šæ€¥ä¿®å¾©ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
      adminGrid.classList.add('emergency-2col');
      
      // iframeä¿®å¾©ã‚·ã‚¹ãƒ†ãƒ ãŒã‚ã‚Œã°å®Ÿè¡Œ
      if (window.iframeLayoutSystem) {
        window.iframeLayoutSystem.forceRepair();
      }
      
      // bodyã«ãƒ‡ãƒãƒƒã‚°ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
      document.body.classList.add('tailwind-override-protection');
      
      console.log('ğŸ”§ [UNIFIED LAYOUT] Emergency repair completed');
      
      // ä¿®å¾©å¾Œã«å†æ¤œè¨¼
      setTimeout(() => this.verifyLayout(), 200);
    }
  },
  
  // æ‰‹å‹•ä¿®å¾©ç”¨ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°
  manualRepair: function() {
    console.log('ğŸ”§ [UNIFIED LAYOUT] Manual repair requested');
    this.emergencyRepair();
  }
};

// ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¢ã‚¯ã‚»ã‚¹ç”¨é–¢æ•°
window.fixAdminLayout = function() {
  window.unifiedLayoutSystem.manualRepair();
};

// ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
window.debugLayout = function(enable = true) {
  if (enable) {
    document.body.classList.add('debug-layout');
    console.log('ğŸ› Layout debug mode enabled');
  } else {
    document.body.classList.remove('debug-layout');
    console.log('ğŸ› Layout debug mode disabled');
  }
};

// ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç›£è¦–
if (typeof ResizeObserver !== 'undefined') {
  const layoutObserver = new ResizeObserver(entries => {
    entries.forEach(entry => {
      if (entry.target.classList.contains('admin-responsive-grid')) {
        console.log('ğŸ“ [UNIFIED LAYOUT] Size change detected:', {
          width: entry.contentRect.width,
          height: entry.contentRect.height,
          timestamp: new Date().toLocaleTimeString()
        });
      }
    });
  });
  
  // ç›£è¦–é–‹å§‹
  setTimeout(() => {
    const adminGrid = document.querySelector('.admin-responsive-grid');
    if (adminGrid) {
      layoutObserver.observe(adminGrid);
      console.log('ğŸ‘ï¸ [UNIFIED LAYOUT] Monitoring started');
    }
  }, 300);
}

// ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
window.unifiedLayoutSystem.init();
</script>