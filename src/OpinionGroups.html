<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-4">
  <h1 class="text-xl font-bold mb-4">意見のグループ化</h1>
  <div id="groups" class="space-y-4 text-sm"></div>
  <script>
    google.script.run.withSuccessHandler(render).groupSimilarOpinions();
    function render(groups) {
      const container = document.getElementById('groups');
      if (typeof groups === 'string') {
        container.innerHTML = '<pre class="whitespace-pre-wrap">' +
          groups +
          '</pre>';
        return;
      }
      if (!groups || !groups.length) {
        container.innerHTML = '<p>結果がありません。</p>';
        return;
      }
      container.innerHTML = '';
      groups.forEach(g => {
        const div = document.createElement('div');
        div.className = 'p-2 rounded bg-gray-100';
        const title = document.createElement('h2');
        title.className = 'font-semibold mb-1';
        title.textContent = g.topic || 'グループ';
        const ul = document.createElement('ul');
        (g.opinions || []).forEach(op => {
          const li = document.createElement('li');
          li.textContent = op;
          ul.appendChild(li);
        });
        div.appendChild(title);
        div.appendChild(ul);
        container.appendChild(div);
      });
    }
  </script>
</body>
</html>
