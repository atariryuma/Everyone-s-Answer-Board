# StudyQuest - みんなの回答ボード

「みんなの回答ボード」へようこそ！ これは、生徒たちの多様な意見をリアルタイムで共有し、活発な議論を促すためのウェブアプリです。Googleスプレッドシートと連携し、むずかしい設定なしでかんたんに利用を開始できます。

![回答ボードのスクリーンショット](https://user-images.githubusercontent.com/11654392/157599816-2a1a35a9-e879-4049-913c-8896848f892b.png)

## ✨ 主な特徴

*   **ワンクリックでボード作成**: Googleフォームと連携した回答ボードを、ボタンひとつでかんたんに作成・公開できます。
*   **リアルタイム共有**: 生徒の回答がリアルタイムでボードに反映され、すぐに全員で共有できます。
*   **匿名での意見交換**: 安心して意見を表明できるよう、名前を隠して利用できます。
*   **カラフルなリアクション機能**: 「いいね！」「なるほど！」といったリアクションで、言葉にしなくても共感や関心を伝えられます。
*   **安全・安心の設計**:
    *   学校のドメイン内でのみ利用できるため、部外者のアクセスを防ぎます。
    *   公開したボードは、安全のため6時間で自動的に非公開になります。

## 🚀 はじめての使い方（管理者向け）

このアプリを利用するには、Google Apps Scriptへの初回デプロイ（公開）作業が必要です。

### 1. スクリプトの準備

1.  **Google Apps Scriptを開く**: [script.google.com](https://script.google.com) にアクセスし、新しいプロジェクトを作成します。
2.  **コードをコピーする**: このリポジトリの `src/` ディレクトリにあるすべてのファイル（`.gs` と `.html`）の内容を、作成したプロジェクトにコピー＆ペーストします。
    *   `Code.gs` の内容は、Apps Scriptエディタの `コード.gs` に貼り付けます。
    *   その他の `.html` ファイルは、「ファイル」 > 「新規作成」 > 「HTMLファイル」から同名のファイルを作成し、内容を貼り付けてください。

### 2. ウェブアプリとして公開（デプロイ）

1.  エディタ右上の「**デプロイ**」ボタンを押し、「**新しいデプロイ**」を選択します。
2.  「種類の選択」で歯車アイコンをクリックし、「**ウェブアプリ**」を選択します。
3.  以下の設定でデプロイします。
    *   **説明**: （空欄でOK）
    *   **次のユーザーとして実行**: `自分`
    *   **アクセスできるユーザー**: あなたの学校のドメイン（例: `naha-okinawa.ed.jp`）
4.  「**デプロイ**」ボタンを押します。初回は「承認」を求められるので、画面の指示に従って許可してください。
5.  表示された**ウェブアプリURL**をコピーして、大切に保管してください。これがあなたの「みんなの回答ボード」の基本URLになります。

### 3. 初期設定

1.  コピーしたウェブアプリURLの末尾に `?mode=admin` を付けて、ブラウザでアクセスします。
    *   例: `https://script.google.com/a/macros/domain.com/s/xxxxx/exec?mode=admin`
2.  これがあなたの**管理画面**です。ブックマークしておきましょう。
3.  管理画面の「クイックアクション」から「**新しいボードを作成して公開**」ボタンを押すだけで、すぐに授業で使える回答ボードが完成します！

## 🧑‍🏫 授業での使い方

1.  **ボードの作成**: 管理画面の「**新しいボードを作成して公開**」ボタンを押します。
2.  **フォームの共有**: 作成された**GoogleフォームのURL**を生徒に共有し、回答を投稿してもらいます。
3.  **回答ボードの共有**: 管理画面下部に表示される**ボードのURL**を生徒に共有すると、全員の回答をリアルタイムで見ることができます。

## ⚙️ 管理画面でできること

*   **ボードの作成と公開**: ワンクリックで新しいボードを作成・公開できます。
*   **既存スプレッドシートの利用**: すでにあるGoogleスプレッドシートを回答ボードとして利用することも可能です。
*   **表示ボードの切り替え**: 複数のシートがある場合、生徒に表示するボードを切り替えられます。
*   **表示設定**: 生徒の名前やリアクション数を表示するかどうかを設定できます。
*   **公開終了**: 公開中のボードをいつでも非公開にできます。

## 🔒 セキュリティについて

StudyQuest「みんなの回答ボード」は、Google Apps Script (GAS) を基盤とし、教育現場での利用を想定した高いセキュリティ基準で設計されています。

### アプリのアーキテクチャとデータ管理
本アプリは、大きく分けて2つの主要なコンポーネントで構成されています。

*   **メインウェブアプリ (GAS Web App)**: 生徒や先生がアクセスするフロントエンドと、Googleサービス（スプレッドシート、フォーム、Driveなど）と連携するバックエンドロジックを担います。
*   **Logger API (GAS Web App)**: ユーザー情報や監査ログなど、機密性の高いデータを管理するための独立したバックエンドAPIです。

これにより、生徒の回答データやユーザー設定は、メインウェブアプリとは分離されたLogger API経由でアクセスされるデータベースに安全に保存されます。万が一、メインウェブアプリに脆弱性が見つかった場合でも、ユーザーデータへの直接的なアクセスを防ぐ多層防御の仕組みを採用しています。

### 主なセキュリティ機能

*   **データ分離とAPI連携**: ユーザーデータはメインアプリから独立したデータベースで管理され、API経由でのみアクセスされます。これにより、データの漏洩リスクを最小限に抑えます。
*   **厳格なドメインベースのアクセス制御**: アプリケーションは、デプロイされたGoogle Workspaceドメイン内からのアクセスに限定されます。これにより、組織外からの不正なアクセスを防止します。
*   **XSS (クロスサイトスクリプティング) 対策**: 全てのユーザー入力は厳重にサニタイズされ、悪意のあるスクリプトの埋め込みを防ぎます。動的に生成されるHTMLコンテンツも適切にエスケープ処理されます。
*   **レート制限**: 短時間での連続操作（例: 新規登録、リアクション）を制限することで、システムへの過負荷や悪意のある自動操作を防ぎます。
*   **自動非公開機能**: 公開されたボードは一定時間（例: 6時間）経過後に自動的に非公開状態に戻ります。これにより、意図しない情報公開が続くことを防ぎます。
*   **Google Apps Scriptのセキュリティ機能活用**: Googleが提供するGASの組み込みセキュリティ機能（例: クリックジャッキング対策のためのX-Frame-Optionsヘッダー設定）を最大限に活用し、一般的なウェブ脆弱性から保護します。
*   **Google Driveのアクセス権限管理**: 作成されるスプレッドシートやフォームは、適切なアクセス権限（例: ドメイン内での共有）が自動的に設定され、不必要な外部共有を防ぎます。

これらの対策により、「みんなの回答ボード」は教育現場で安心してご利用いただけるよう、データの安全性とプライバシー保護に最大限配慮しています。

---
このREADMEが、先生方にとって分かりやすく、このツールの活用の一助となることを願っています。